#include <windows.h>
#include <stdio.h>
#include <TlHelp32.h>

int main(){
    HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS,0);
    if(hSnapshot == INVALID_HANDLE_VALUE){
        printf("Failed to Create snapshot\n");
        return 0;
    }
    PROCESSENTRY32 pe;
    pe.dwSize = sizeof(pe);
    if(! Process32First(hSnapshot, &pe)){
        printf("Failed to Get the first entry");
        CloseHandle(hSnapshot);
        return 0;
    }
    do {
        printf("PID:%d,  PPID:%d, Name:%s \n", pe.th32ProcessID, pe.th32ParentProcessID, pe.szExeFile);
    } while(Process32Next(hSnapshot, &pe));

    CloseHandle(hSnapshot);
    printf("Done!\n");
}